#![allow(dead_code)]
use anyhow::Result;
use ethers::{abi::Abi, contract::Contract, core::types::Address, providers::Middleware};
use std::sync::Arc;

pub fn build_default<M: Middleware>(client: impl Into<Arc<M>>) -> Result<Contract<M>> {
    let address = "1be63db5051C126f54Ad0807E1B471ad9AA0befD";
    let hx = hex::decode(address).unwrap();
    let addr = Address::from_slice(hx.as_slice());
    build_contract(addr, client)
}

pub fn build_kovan<M: Middleware>(client: impl Into<Arc<M>>) -> Result<Contract<M>> {
    let address = "68B5fBd7CEFEE3076e4101920b13C9Cc1A6cbF0e";
    build_contract_string(address, client)
}

pub fn build_goerli<M: Middleware>(client: impl Into<Arc<M>>) -> Result<Contract<M>> {
    let address = "1229036F63679B61910CB1463e5BB57f68D19bb2";
    build_contract_string(address, client)
}

fn build_contract_string<M: Middleware, T: ToString>(
    address: T,
    client: impl Into<Arc<M>>,
) -> Result<Contract<M>> {
    let hx = hex::decode(address.to_string()).unwrap();
    let addr = Address::from_slice(hx.as_slice());
    build_contract(addr, client)
}

fn build_contract<M: Middleware>(
    address: Address,
    client: impl Into<Arc<M>>,
) -> Result<Contract<M>> {
    let abi: Abi = serde_json::from_str(ABI)?;
    Ok(Contract::new(address, abi, client))
}

const ABI: &str = r#"[{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"strategist","type":"address"},{"indexed":false,"internalType":"uint256[]","name":"trades","type":"uint256[]"}],"name":"LogBatchMarketMakingTrades","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"strategist","type":"address"},{"indexed":false,"internalType":"uint256[]","name":"scrubbedOfferIDs","type":"uint256[]"}],"name":"LogBatchRequoteOffers","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"strategist","type":"address"},{"indexed":false,"internalType":"uint256","name":"scrubbedOfferID","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"newOfferID","type":"uint256"}],"name":"LogRequote","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"strategistIDScrubbed","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"assetFill","type":"uint256"},{"indexed":false,"internalType":"address","name":"bathAssetAddress","type":"address"},{"indexed":false,"internalType":"uint256","name":"quoteFill","type":"uint256"},{"indexed":false,"internalType":"address","name":"quoteAddress","type":"address"}],"name":"LogScrubbedStratTrade","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"strategist","type":"address"},{"indexed":false,"internalType":"address","name":"asset","type":"address"},{"indexed":false,"internalType":"uint256","name":"amountOfReward","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"}],"name":"LogStrategistRewardClaim","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"strategistTradeID","type":"uint256"},{"indexed":false,"internalType":"bytes32","name":"askId","type":"bytes32"},{"indexed":false,"internalType":"bytes32","name":"bidId","type":"bytes32"},{"indexed":false,"internalType":"address","name":"askAsset","type":"address"},{"indexed":false,"internalType":"address","name":"bidAsset","type":"address"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"},{"indexed":false,"internalType":"address","name":"strategist","type":"address"}],"name":"LogStrategistTrade","type":"event"},{"inputs":[],"name":"RubiconMarketAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"admin","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"assetToSell","type":"address"},{"internalType":"uint256","name":"amountToSell","type":"uint256"},{"internalType":"address","name":"assetToTarget","type":"address"}],"name":"adminRebalanceFunds","outputs":[{"internalType":"uint256","name":"fill_amt","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"strategist","type":"address"}],"name":"approveStrategist","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"approvedStrategists","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[2]","name":"tokenPair","type":"address[2]"},{"internalType":"uint256[]","name":"askNumerators","type":"uint256[]"},{"internalType":"uint256[]","name":"askDenominators","type":"uint256[]"},{"internalType":"uint256[]","name":"bidNumerators","type":"uint256[]"},{"internalType":"uint256[]","name":"bidDenominators","type":"uint256[]"}],"name":"batchMarketMakingTrades","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256[]","name":"ids","type":"uint256[]"},{"internalType":"address[2]","name":"tokenPair","type":"address[2]"},{"internalType":"uint256[]","name":"askNumerators","type":"uint256[]"},{"internalType":"uint256[]","name":"askDenominators","type":"uint256[]"},{"internalType":"uint256[]","name":"bidNumerators","type":"uint256[]"},{"internalType":"uint256[]","name":"bidDenominators","type":"uint256[]"}],"name":"batchRequoteOffers","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"asset","type":"address"},{"internalType":"address","name":"quote","type":"address"},{"internalType":"address","name":"strategist","type":"address"},{"internalType":"uint256[]","name":"ids","type":"uint256[]"}],"name":"flushDeprecatedStratOrders","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"asset","type":"address"},{"internalType":"address","name":"quote","type":"address"},{"internalType":"address","name":"strategist","type":"address"}],"name":"getOutstandingStrategistTrades","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"asset","type":"address"},{"internalType":"address","name":"quote","type":"address"},{"internalType":"address","name":"strategist","type":"address"}],"name":"getStrategistTotalLiquidity","outputs":[{"internalType":"uint256","name":"quoteWeiAmount","type":"uint256"},{"internalType":"uint256","name":"assetWeiAmount","type":"uint256"},{"internalType":"bool","name":"status","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"market","type":"address"}],"name":"initialize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"initialized","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"wouldBeStrategist","type":"address"}],"name":"isApprovedStrategist","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"outOffersByStrategist","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[2]","name":"tokenPair","type":"address[2]"},{"internalType":"uint256","name":"askNumerator","type":"uint256"},{"internalType":"uint256","name":"askDenominator","type":"uint256"},{"internalType":"uint256","name":"bidNumerator","type":"uint256"},{"internalType":"uint256","name":"bidDenominator","type":"uint256"}],"name":"placeMarketMakingTrades","outputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"strategist","type":"address"}],"name":"removeStrategist","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"address[2]","name":"tokenPair","type":"address[2]"},{"internalType":"uint256","name":"askNumerator","type":"uint256"},{"internalType":"uint256","name":"askDenominator","type":"uint256"},{"internalType":"uint256","name":"bidNumerator","type":"uint256"},{"internalType":"uint256","name":"bidDenominator","type":"uint256"}],"name":"requote","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"scrubStrategistTrade","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256[]","name":"ids","type":"uint256[]"}],"name":"scrubStrategistTrades","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"assetToSell","type":"address"},{"internalType":"uint256","name":"amountToSell","type":"uint256"},{"internalType":"address","name":"assetToTarget","type":"address"},{"internalType":"uint24","name":"poolFee","type":"uint24"}],"name":"strategistRebalanceFunds","outputs":[{"internalType":"uint256","name":"fill_amt","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"strategistTrades","outputs":[{"internalType":"uint256","name":"askId","type":"uint256"},{"internalType":"uint256","name":"askPayAmt","type":"uint256"},{"internalType":"address","name":"askAsset","type":"address"},{"internalType":"uint256","name":"bidId","type":"uint256"},{"internalType":"uint256","name":"bidPayAmt","type":"uint256"},{"internalType":"address","name":"bidAsset","type":"address"},{"internalType":"address","name":"strategist","type":"address"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"totalFillsPerAsset","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}]"#;
